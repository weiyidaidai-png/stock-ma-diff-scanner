# 项目结构

```
stock_ma_diff_tool/                    # 项目根目录
├── app.py                             # Flask应用主文件
│   ├── Flask应用初始化和配置          #
│   ├── 路由定义（首页、API接口）      #
│   ├── 后台分析线程管理              #
│   └── 错误处理和响应格式化          #
├── config.py                          # 配置文件
│   ├── tushare API token配置         #
│   ├── 默认参数设置（长期周期、阈值） #
│   └── API调用延迟配置              #
├── stock_data.py                      # 股票数据获取模块
│   ├── tushare API初始化            #
│   ├── A股股票列表获取              #
│   ├── 股票日线数据获取（前复权）    #
│   ├── 数据缓存机制                #
│   └── API调用频率控制              #
├── stock_analyzer.py                  # 股票分析核心逻辑
│   ├── 单只股票均线差异计算          #
│   ├── 批量股票分析和筛选            #
│   ├── 股票详情数据准备（图表用）    #
│   └── 分析结果统计和格式化          #
├── templates/                        # 前端模板目录
│   └── index.html                    # 主页面模板
│       ├── 响应式HTML结构           #
│       ├── CSS样式设计             #
│       ├── JavaScript交互逻辑       #
│       ├── ECharts图表集成         #
│       └── 异步请求处理             #
├── requirements.txt                  # 依赖包列表
├── run.py                            # 启动脚本
├── test.py                           # 功能测试脚本
├── README.md                         # 详细使用说明
├── QUICKSTART.md                     # 快速开始指南
├── DEMO.md                           # 功能演示文档
└── PROJECT_STRUCTURE.md              # 项目结构说明
```

## 文件说明

### 核心文件

1. **app.py** - Flask后端服务
   - 提供Web界面和API接口
   - 处理用户请求和参数配置
   - 管理后台分析线程
   - 返回JSON格式的响应数据

2. **stock_data.py** - 数据获取层
   - 封装tushare API调用
   - 处理API调用限制和错误
   - 实现数据缓存，提高效率
   - 提供股票列表和行情数据

3. **stock_analyzer.py** - 业务逻辑层
   - 实现均值计算和差异分析
   - 执行股票筛选和排序
   - 准备图表所需的详细数据
   - 提供统计信息

4. **templates/index.html** - 前端界面
   - 用户友好的Web界面
   - 参数配置表单
   - 筛选结果展示
   - 交互式价格走势图

### 辅助文件

1. **config.py** - 配置管理
   - 集中管理所有配置参数
   - 方便用户修改和扩展
   - 包含默认参数设置

2. **requirements.txt** - 依赖管理
   - 列出所有必需的Python库
   - 版本号指定，确保兼容性
   - 方便环境搭建

3. **run.py** - 启动工具
   - 简化用户启动流程
   - 自动检查配置和依赖
   - 提供友好的启动提示

4. **test.py** - 测试验证
   - 验证核心功能是否正常
   - 帮助用户检查环境配置
   - 提供问题诊断信息

### 文档文件

1. **README.md** - 详细说明
   - 项目介绍和功能特点
   - 完整的安装和配置指南
   - 详细的使用说明
   - 技术细节和常见问题

2. **QUICKSTART.md** - 快速上手
   - 简化的安装步骤
   - 基本的使用示例
   - 常见问题解决
   - 适合新手用户

3. **DEMO.md** - 功能演示
   - 界面和功能演示
   - 使用场景介绍
   - 性能表现说明
   - 扩展功能建议

4. **PROJECT_STRUCTURE.md** - 结构说明
   - 完整的项目结构
   - 文件功能说明
   - 代码组织架构
   - 扩展开发指南

## 技术架构

```
┌─────────────────┐    HTTP请求/响应    ┌─────────────────┐
│   Web浏览器     │ ◄─────────────────► │   Flask后端     │
└─────────────────┘                     └─────────────────┘
                                              │
                                              ▼
┌─────────────────┐    函数调用          ┌─────────────────┐
│  stock_data.py  │ ◄─────────────────► │ 业务逻辑处理    │
│  (数据获取层)   │                     │ (app.py)        │
└─────────────────┘                     └─────────────────┘
                                              │
                                              ▼
┌─────────────────┐    函数调用          ┌─────────────────┐
│ stock_analyzer.py │ ◄─────────────────► │ 数据分析处理    │
│  (业务逻辑层)   │                     │ (app.py)        │
└─────────────────┘                     └─────────────────┘
                                              │
                                              ▼
┌─────────────────┐    API调用           ┌─────────────────┐
│   tushare API   │ ◄─────────────────► │ 数据获取处理    │
│  (数据来源)     │                     │ (stock_data.py) │
└─────────────────┘                     └─────────────────┘
```

## 代码特点

### 模块化设计
- 清晰的分层架构
- 松耦合的模块设计
- 易于维护和扩展

### 用户友好
- 直观的Web界面
- 详细的使用文档
- 完善的错误提示

### 性能优化
- API调用频率控制
- 数据缓存机制
- 后台异步处理

### 稳定性
- 完善的错误处理
- 重试机制
- 异常捕获

## 扩展开发

项目采用模块化设计，易于扩展：

1. **添加新的数据来源**：在stock_data.py中添加新的数据源
2. **添加新的分析指标**：在stock_analyzer.py中添加新的分析方法
3. **扩展Web界面**：在templates/index.html中添加新的功能
4. **添加新的API接口**：在app.py中添加新的路由

这种设计确保了项目的可维护性和可扩展性，适合长期发展和功能扩展。